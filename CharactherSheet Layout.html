<!DOCTYPE HTML>
<html>
	<head>
		<title>Charachter Sheet</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<style>
        h1 {
            text-align: center;
            color: #333;
			margin-bottom: 20px;
			margin-top: -10px;
        }
		.character-sheet-title{
			width: 400px;
			padding: 10px;
		}
        .section {
            margin-bottom: -5px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .section-title {
            font-weight: bold;
            font-size: 2em;
            margin-bottom: 10px;
            color: #444;
			justify-content: center;
			display: flex;
        }
		.levelSelection{
			margin-top: 10px;;
			background-color: lightblue;
			width: 220px;
			box-shadow: 10px black;
			border-radius: 0% 8px 8px 0%;
		}
			.levelSelection p{
			font-size: larger;
			margin-left: 4%;
			color: black;
			}
		.container {
			display: flex;
			flex-direction: row;
			}

			.sidebar {
				width: 220px;
				background-color: lightblue;
				box-shadow: 10px black;
				border-radius: 0% 8px 8px 0%;
				margin-right: 20px; /* Optional: Add spacing between sidebar and main content */
			}

		.main-content {
			flex: 1;
			height: calc(100vh - 3.8em);
			margin-left: -1em;
			padding-left: .5em;
			padding-right: .5em;
			min-width: 0;
			min-height: 0;
		}
		.character-info-container {
			display: flex;
			flex-direction: column;
			max-width: 800px;
			gap: 20px;
		}
		.top-row{
			display: flex;
			flex-direction: row;
		}
		.lowerHalf-row{
			display: flex;
			flex-flow: row;
			height: calc(100vh - 17.8em);
			min-width: 0;
			min-height: 0;
		}
		.skillsContainer{
			display: inline-flex;
			flex-direction: colum n;
			margin-top: 0.5em;
			margin-bottom: 0.5em;
		}
		.skillsScroll{
			/*flex: 1 1 auto;
			overflow-y: auto;
			overflow-x: hidden;
			height: 0;*/
		}
		.spellsContainer{
			display: inline-flex;
			flex-direction: column;
			margin-top: 0.5em;
			margin-bottom: 0.5em;
			width: 400px;
		}
		.spellData{
			display: flex;
			flex-direction: row;
		}
		/* Blue Box: Level, Initiative, Perception, and Bars */
		.character-top-box {
			border: 2px solid blue;
			border-radius: 8px;
			padding: 10px;
			background-color: rgba(0, 0, 255, 0.1);
			height: fit-content;
		}

		/* Red Box: Stats and Saving Throws */
		.character-stats-box {
			border: 2px solid red;
			border-radius: 8px;
			padding: 10px;
			background-color: rgba(255, 0, 0, 0.1);
		}

		/* Form Row Styling */
		.form-row {
			display: flex;
			justify-content: space-between;
			margin-bottom: 15px;
		}

		.form-group {
			flex: 1;
			margin: 0 5px;
		}

		/* Resource Bars Container */
		.resource-bars-container {
			margin-bottom: 10px;
		}

		/* Section Titles */
		.section-title {
			font-weight: bold;
			margin-bottom: 10px;
			padding-bottom: 5px;
			border-bottom: 1px solid #333;
		}

		/* Stats Wrapper */
		.stats-wrapper {
			display: flex;
			flex-wrap: wrap;
			gap: 10px;
		}

		/* Stat Boxes */
		.character-stats-box {
			width: 550px;
		}
    </style>
	<body class="is-preload">
		<!-- Header -->
		<div id="header-placeholder"></div>
		<div class="container">
			<!-- Sidebar -->
			<div class="sidebar">
				<div class="levelSelection" id="levelZero">
					<div class="form-group">
						<p>Name</p>
						<input type="text" placeholder="Character Name" id="charName">
					</div>
					<div class="form-group">
						<p>Species</p>
						<input type="text" placeholder="Species" id="charSpecies">
					</div>
					<div class="form-group">
						<p>Background</p>
						<input type="text" placeholder="Background" id="charBackground">
					</div>
				</div>
				<div class="levelSelection" id="levelOne">
					<p>Level One</p>
					<div class="form-group">
						<p>Advantage</p>
						<input type="text" placeholder="Advatage">
					</div>
					<div class="form-group">
						<p>Arcane Feat</p>
						<input type="text" placeholder="Arcane Feat">
					</div>
					<div class="form-group">
						<p>Arcane Feat</p>
						<input type="text" placeholder="Arcane Feat">
					</div>
					<div class="form-group">
						<p>General Feat</p>
						<input type="text" placeholder="General Feat">
					</div>
					<div class="form-group">
						<p>Ancestry Feat</p>
						<input type="text" placeholder="Ancestry Feat">
					</div>
				</div>	
			</div>	
			<!-- Body-->
			<div class="main-content">
				<div class="top-row">
					<!-- Red Box: Stats and Saving Throws -->
					<div class="character-info-container">
						<div class="character-stats-box">
							<div class="section">
								<div class="section-title">Stats</div>
								<div class="stats-wrapper">
									<div class="stats-container">
										<div class="stat-box">
											<p>Physique</p>
											<div class="stat-input-container">
												<div class="stat-label">PHY</div>
												<input type="number" class="stat-input" id="phy" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
											</div>
										</div>
										<div class="stat-box">
											<p>Dexterity</p>
											<div class="stat-input-container">
												<div class="stat-label">DEX</div>
												<input type="number" class="stat-input" id="dex" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
											</div>
										</div>
										<div class="stat-box">
											<p>Intelligence</p>
											<div class="stat-input-container">
												<div class="stat-label">INT</div>
												<input type="number" class="stat-input" id="int" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
											</div>
										</div>
										<div class="stat-box">
											<p>Willpower</p>
											<div class="stat-input-container">
												<div class="stat-label">WIL</div>
												<input type="number" class="stat-input" id="wil" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="section">
								<div class="section-title">Saving Throws</div>
								<div class="stats-wrapper">
									<div class="stats-container">
										<div class="save-box">
											<div class="stat-label">Fortitude (PHY)</div>
											<p class="stat-input" id="fortitude">0</p>
											<div class ="save-proficiency-box">
												<button class="proficiency-button" onclick="setProficiency('fortitude', 0, this)">U</button> 
												<button class="proficiency-button" onclick="setProficiency('fortitude', 3, this)">T</button>
												<button class="proficiency-button" onclick="setProficiency('fortitude', 6, this)">E</button>
												<button class="proficiency-button" onclick="setProficiency('fortitude', 9, this)">M</button>
											</div>
										</div>
										<div class="save-box">
											<div class="stat-label">Reflex (DEX)</div>
											<p class="stat-input" id="reflex">0</p>
											<div class ="save-proficiency-box">
												<button class="proficiency-button" onclick="setProficiency('reflex', 0, this)">U</button>
												<button class="proficiency-button" onclick="setProficiency('reflex', 3, this)">T</button>
												<button class="proficiency-button" onclick="setProficiency('reflex', 6, this)">E</button>
												<button class="proficiency-button" onclick="setProficiency('reflex', 9, this)">M</button>
											</div>
										</div>
										<div class="save-box">
											<div class="stat-label">Will (WIL)</div>
											<p class="stat-input" id="will">0</p>
											<div class ="save-proficiency-box">
												<button class="proficiency-button" onclick="setProficiency('will', 0, this)">U</button>
												<button class="proficiency-button" onclick="setProficiency('will', 3, this)">T</button>
												<button class="proficiency-button" onclick="setProficiency('will', 6, this)">E</button>
												<button class="proficiency-button" onclick="setProficiency('will', 9, this)">M</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="character-sheet-title">
						<h1><u>Kastorix <br>Character Sheet</u></h1>
						<div class="saveLoadSection">
							<button class="saveload-button" onclick="saveSheet()">Save Character</button>
							<button class="saveload-button" onclick="loadSheet()">Load Character</button>
							<button class="saveload-button" onclick="deleteSheet()">Delete Character</button>

							<div class="section">
								<div class="section-title">Export/Import</div>
								<button class="saveload-button" onclick="exportCharacter()">Export Character</button>
								<input type="file" id="importFile" accept=".json" onchange="importCharacter(event)" style="display: none;">
								<button class="saveload-button" onclick="document.getElementById('importFile').click()">Import Character</button>
							</div>
						</div>
					</div>
					<!-- Blue Box: Level, Initiative, Perception, and Bars -->
					<div class="character-top-box">
						<div class="form-row">
							<div class="form-group">
								<p>Level</p>
								<input type="number" placeholder="1" id="charLevel">
							</div>
							<div class="form-group">
								<p>Initiative</p>
								<input type="number" placeholder="0" id="initiative">
							</div>
							<div class="form-group">
								<p>Passive Perception</p>
								<input type="number" placeholder="10" id="passivePerception">
							</div>
						</div>
						<!-- Resource Bars Container -->
						<div class="resource-bars-container">
							<!-- Health Bar -->
							<div class="resource-bar-wrapper">
								<div class="bar-container">
									<div id="healthBar" class="bar" style="width: 50%; background-color: #ff4d4d;"></div>
								</div>
								<div class="resource-inputs">
									<label for="health">Health:</label>
									<input type="number" id="health" min="0" max="100" value="10" oninput="updateBar('health')">
									/
									<input type="number" id="maxHealth" min="1" max="100" value="10" oninput="updateBar('health')">
								</div>
							</div>

							<!-- Aura Bar -->
							<div class="resource-bar-wrapper">
								<div class="bar-container">
									<div id="auraBar" class="bar" style="width: 30%; background-color: #4da6ff;"></div>
								</div>
								<div class="resource-inputs">
									<label for="aura">Aura:</label>
									<input type="number" id="aura" min="0" max="100" value="10" oninput="updateBar('aura')">
									/
									<input type="number" id="maxAura" min="1" max="100" value="10" oninput="updateBar('aura')">
								</div>
							</div>

							<!-- Mana Bar -->
							<div class="resource-bar-wrapper">
								<div class="bar-container">
									<div id="manaBar" class="bar" style="width: 70%; background-color: #b34dff;"></div>
								</div>
								<div class="resource-inputs">
									<label for="mana">Mana:</label>
									<input type="number" id="mana" min="0" max="100" value="10" oninput="updateBar('mana')">
									/
									<input type="number" id="maxMana" min="1" max="100" value="10" oninput="updateBar('mana')">
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="lowerHalf-row">
					<div class="skillsContainer">
						<div class="skillsScroll">
							<div class="section-title">Skills</div>
							<table id="skillsTable">
								<thead>
									<tr>
										<th>Skill</th>
										<th>Stat</th>
										<th>Modifier</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>Acrobatics</td>
										<td>DEX</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('acrobatics', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('acrobatics', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('acrobatics', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('acrobatics', 9, this)">M</button>
											<p class="skill-input" id="acrobatics">0</p>
										</td>
									</tr>
									<tr>
										<td>Arcana</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('arcana', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('arcana', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('arcana', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('arcana', 9, this)">M</button>
											<p class="skill-input" id="arcana">0</p>
										</td>
									</tr>
									<tr>
										<td>Athletics</td>
										<td>PHY</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('athletics', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('athletics', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('athletics', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('athletics', 9, this)">M</button>
											<p class="skill-input" id="athletics">0</p>
										</td>
									</tr>
									<tr>
										<td>Crafting</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('crafting', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('crafting', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('crafting', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('crafting', 9, this)">M</button>
											<p class="skill-input" id="crafting">0</p>
										</td>
									</tr>
									<tr>
										<td>Deception</td>
										<td>WIL</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('deception', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('deception', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('deception', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('deception', 9, this)">M</button>
											<p class="skill-input" id="deception">0</p>
										</td>
									</tr>
									<tr>
										<td>History</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('history', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('history', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('history', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('history', 9, this)">M</button>
											<p class="skill-input" id="history">0</p>
										</td>
									</tr>
									<tr>
										<td>Insight</td>
										<td>WIL</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('insight', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('insight', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('insight', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('insight', 9, this)">M</button>
											<p class="skill-input" id="insight">0</p>
										</td>
									</tr>
									<tr>
										<td>Intimidation</td>
										<td>PHY</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('intimidation', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('intimidation', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('intimidation', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('intimidation', 9, this)">M</button>
											<p class="skill-input" id="intimidation">0</p>
										</td>
									</tr>
									<tr>
										<td>Medicine</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('medicine', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('medicine', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('medicine', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('medicine', 9, this)">M</button>
											<p class="skill-input" id="medicine">0</p>
										</td>
									</tr>
									<tr>
										<td>Mana Sensing</td>
										<td>WIL</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('manaSensing', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('manaSensing', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('manaSensing', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('manaSensing', 9, this)">M</button>
											<p class="skill-input" id="manaSensing">0</p>
										</td>
									</tr>
									<tr>
										<td>Nature</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('nature', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('nature', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('nature', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('nature', 9, this)">M</button>
											<p class="skill-input" id="nature">0</p>
										</td>
									</tr>
									<tr>
										<td>Perception</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('perception', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('perception', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('perception', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('perception', 9, this)">M</button>
											<p class="skill-input" id="perception">0</p>
										</td>
									</tr>
									<tr>
										<td>Performance</td>
										<td>DEX</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('performance', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('performance', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('performance', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('performance', 9, this)">M</button>
											<p class="skill-input" id="performance">0</p>
										</td>
									</tr>
									<tr>
										<td>Persuasion</td>
										<td>WIL</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('persuasion', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('persuasion', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('persuasion', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('persuasion', 9, this)">M</button>
											<p class="skill-input" id="persuasion">0</p>
										</td>
									</tr>
									<tr>
										<td>Society</td>
										<td>INT</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('society', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('society', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('society', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('society', 9, this)">M</button>
											<p class="skill-input" id="society">0</p>
										</td>
									</tr>
									<tr>
										<td>Sleight of Hand</td>
										<td>DEX</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 9, this)">M</button>
											<p class="skill-input" id="sleightOfHand">0</p>
										</td>
									</tr>
									<tr>
										<td>Stealth</td>
										<td>DEX</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('stealth', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('stealth', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('stealth', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('stealth', 9, this)">M</button>
											<p class="skill-input" id="stealth">0</p>
										</td>
									</tr>
									<tr>
										<td>Survival</td>
										<td>WIL</td>
										<td>
											<button class="proficiency-button" onclick="setProficiency('survival', 0, this)">U</button>
											<button class="proficiency-button" onclick="setProficiency('survival', 3, this)">T</button>
											<button class="proficiency-button" onclick="setProficiency('survival', 6, this)">E</button>
											<button class="proficiency-button" onclick="setProficiency('survival', 9, this)">M</button>
											<p class="skill-input" id="survival">0</p>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="spellsContainer">
						<div class="section-title">Spells</div>
						<div class="spellSection">
							<div class="spellData">
								<textarea id="spellName" placeholder="Spellname"></textarea>
								<textarea id="spellTraits" placeholder="traits and aspects"></textarea>
								<textarea id="spellActions" placeholder="2"></textarea>
							</div>
							<textarea id="description" placeholder="Spell Effect"></textarea>
						</div>
						<div class="spellSection">
							<div class="spellData">
								<textarea id="spellName" placeholder="Spellname"></textarea>
								<textarea id="spellTraits" placeholder="traits and aspects"></textarea>
								<textarea id="spellActions" placeholder="2"></textarea>
							</div>
							<textarea id="description" placeholder="Spell Effect"></textarea>
						</div>
						<div class="spellSection">
							<div class="spellData">
								<textarea id="spellName" placeholder="Spellname"></textarea>
								<textarea id="spellTraits" placeholder="traits and aspects"></textarea>
								<textarea id="spellActions" placeholder="2"></textarea>
							</div>
							<textarea id="description" placeholder="Spell Effect"></textarea>
						</div>
					</div>
				</div>
			</div>
				
			</div>
			
		</div>
		</div>
	</div>
		<!-- Scripts -->
			<script>
				fetch('rpgheader.html')
					.then(response => response.text())
					.then(data => {
						document.getElementById('header-placeholder').innerHTML = data;
					});

				// Close dropdowns when clicking outside
				window.onclick = function(event) {
					if (!event.target.matches('.dropbtn')) {
						var dropdowns = document.getElementsByClassName("dropdown-content");
						for (var i = 0; i < dropdowns.length; i++) {
							var openDropdown = dropdowns[i];
							if (openDropdown.style.display === "block") {
								openDropdown.style.display = "none";
							}
						}
					}
				};
				// Declare skillProficiencies globally
				window.skillProficiencies = window.skillProficiencies || {};

				function setProficiency(skillId, proficiencyBonus, button) {
					window.skillProficiencies[skillId] = proficiencyBonus;
					// Update active button styling
					const buttons = button.parentNode.querySelectorAll('.proficiency-button');
					buttons.forEach(btn => btn.classList.remove('active'));
					button.classList.add('active');
					// Update the skill modifier
					updateSkillModifiers();
				}

				function updateSkillModifiers() {
					const phyMod = parseInt(document.getElementById('phy').value) || 0;
					const dexMod = parseInt(document.getElementById('dex').value) || 0;
					const intMod = parseInt(document.getElementById('int').value) || 0;
					const wilMod = parseInt(document.getElementById('wil').value) || 0;

					// Update each save modifier
					document.getElementById('fortitude').textContent = phyMod + (window.skillProficiencies.fortitude || 0);
					document.getElementById('reflex').textContent = dexMod + (window.skillProficiencies.reflex || 0);
					document.getElementById('will').textContent = wilMod + (window.skillProficiencies.will || 0);

					// Update each skill modifier
					document.getElementById('acrobatics').textContent = dexMod + (window.skillProficiencies.acrobatics || 0);
					document.getElementById('arcana').textContent = intMod + (window.skillProficiencies.arcana || 0);
					document.getElementById('athletics').textContent = phyMod + (window.skillProficiencies.athletics || 0);
					document.getElementById('crafting').textContent = intMod + (window.skillProficiencies.crafting || 0);
					document.getElementById('deception').textContent = wilMod + (window.skillProficiencies.deception || 0);
					document.getElementById('history').textContent = intMod + (window.skillProficiencies.history || 0);
					document.getElementById('insight').textContent = wilMod + (window.skillProficiencies.insight || 0);
					document.getElementById('intimidation').textContent = phyMod + (window.skillProficiencies.intimidation || 0);
					document.getElementById('medicine').textContent = intMod + (window.skillProficiencies.medicine || 0);
					document.getElementById('manaSensing').textContent = wilMod + (window.skillProficiencies.manaSensing || 0);
					document.getElementById('nature').textContent = intMod + (window.skillProficiencies.nature || 0);
					document.getElementById('perception').textContent = intMod + (window.skillProficiencies.perception || 0);
					document.getElementById('performance').textContent = dexMod + (window.skillProficiencies.performance || 0);
					document.getElementById('persuasion').textContent = wilMod + (window.skillProficiencies.persuasion || 0);
					document.getElementById('society').textContent = intMod + (window.skillProficiencies.society || 0);
					document.getElementById('sleightOfHand').textContent = dexMod + (window.skillProficiencies.sleightOfHand || 0);
					document.getElementById('stealth').textContent = dexMod + (window.skillProficiencies.stealth || 0);
					document.getElementById('survival').textContent = wilMod + (window.skillProficiencies.survival || 0);

					console.log("Skill proficiencies:", window.skillProficiencies);
				}

				function saveSheet() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name.');
						return;
					}

					const charData = {
						name: charName,
						species: document.getElementById('charSpecies').value,
						level: document.getElementById('charLevel').value,
						initiative: document.getElementById('initiative').value,
						passivePerception: document.getElementById('passivePerception').value,

						health: document.getElementById('health').value,
						maxHealth: document.getElementById('maxHealth').value,
						aura: document.getElementById('aura').value,
						maxAura: document.getElementById('maxAura').value,
						mana: document.getElementById('mana').value,
						maxMana: document.getElementById('maxMana').value,

						stats: {
							phy: document.getElementById('phy').value,
							dex: document.getElementById('dex').value,
							int: document.getElementById('int').value,
							wil: document.getElementById('wil').value,
						},
						saves: {
							fortitude: document.getElementById('fortitude').value,
							reflex: document.getElementById('reflex').value,
							will: document.getElementById('will').value,
						},
						skills: {
							acrobatics: document.getElementById('acrobatics').value,
							arcana: document.getElementById('arcana').value,
							athletics: document.getElementById('athletics').value,
							crafting: document.getElementById('crafting').value,
							deception: document.getElementById('deception').value,
							history: document.getElementById('history').value,
							insight: document.getElementById('insight').value,
							intimidation: document.getElementById('intimidation').value,
							medicine: document.getElementById('medicine').value,
							manaSensing: document.getElementById('manaSensing').value,
							nature: document.getElementById('nature').value,
							perception: document.getElementById('perception').value,
							performance: document.getElementById('performance').value,
							persuasion: document.getElementById('persuasion').value,
							society: document.getElementById('society').value,
							sleightOfHand: document.getElementById('sleightOfHand').value,
							stealth: document.getElementById('stealth').value,
							survival: document.getElementById('survival').value
						},
						arcaneFeats: document.getElementById('arcaneFeats').value,
						generalFeats: document.getElementById('generalFeats').value,
						equipment: document.getElementById('equipment').value,
						notes: document.getElementById('notes').value,
					};

					let characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const existingIndex = characters.findIndex(char => char.name === charName);

					if (existingIndex >= 0) {
						characters[existingIndex] = charData;
					} else {
						characters.push(charData);
					}

					localStorage.setItem('ttrpgCharacters', JSON.stringify(characters));
					alert(`Character "${charName}" saved!`);
				}

				function loadSheet() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name to load.');
						return;
					}

					const characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const charData = characters.find(char => char.name === charName);

					if (charData) {
						document.getElementById('charName').value = charData.name;
						document.getElementById('charSpecies').value = charData.species;
						document.getElementById('charLevel').value = charData.level;
						document.getElementById('initiative').value = charData.initiative;
						document.getElementById('passivePerception').value = charData.passivePerception;

						document.getElementById('health').value = charData.health;
						document.getElementById('maxHealth').value = charData.maxHealth;
						document.getElementById('aura').value = charData.aura;
						document.getElementById('maxAura').value = charData.maxAura;
						document.getElementById('mana').value = charData.mana;
						document.getElementById('maxMana').value = charData.maxMana;

						document.getElementById('phy').value = charData.stats.phy;
						document.getElementById('dex').value = charData.stats.dex;
						document.getElementById('int').value = charData.stats.int;
						document.getElementById('wil').value = charData.stats.wil;

						document.getElementById('acrobatics').value = charData.skills.acrobatics;
						document.getElementById('arcana').value = charData.skills.arcana;
						document.getElementById('athletics').value = charData.skills.athletics;
						document.getElementById('crafting').value = charData.skills.crafting;
						document.getElementById('deception').value = charData.skills.deception;
						document.getElementById('history').value = charData.skills.history;
						document.getElementById('insight').value = charData.skills.insight;
						document.getElementById('intimidation').value = charData.skills.intimidation;
						document.getElementById('medicine').value = charData.skills.medicine;
						document.getElementById('manaSensing').value = charData.skills.manaSensing;
						document.getElementById('nature').value = charData.skills.nature;
						document.getElementById('perception').value = charData.skills.perception;
						document.getElementById('performance').value = charData.skills.performance;
						document.getElementById('persuasion').value = charData.skills.persuasion;
						document.getElementById('society').value = charData.skills.society;
						document.getElementById('sleightOfHand').value = charData.skills.sleightOfHand;
						document.getElementById('stealth').value = charData.skills.stealth;
						document.getElementById('survival').value = charData.skills.survival;

						document.getElementById('arcaneFeats').value = charData.arcaneFeats;
						document.getElementById('generalFeats').value = charData.generalFeats;
						document.getElementById('equipment').value = charData.equipment;
						document.getElementById('notes').value = charData.notes;

						alert(`Character "${charName}" loaded!`);
					} else {
						alert(`No saved character found with the name "${charName}".`);
					}
				}


				// Delete a character
				function deleteSheet() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name to delete.');
						return;
					}

					let characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const updatedCharacters = characters.filter(char => char.name !== charName);

					if (updatedCharacters.length === characters.length) {
						alert(`No saved character found with the name "${charName}".`);
					} else {
						localStorage.setItem('ttrpgCharacters', JSON.stringify(updatedCharacters));
						alert(`Character "${charName}" deleted!`);
					}
				}

				// Populate the character list dropdown
				function populateCharacterList() {
					const characterList = document.getElementById('characterList');
					characterList.innerHTML = '<option value="">Select a character...</option>';

					const characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					characters.forEach(char => {
						const option = document.createElement('option');
						option.value = char.name;
						option.textContent = char.name;
						characterList.appendChild(option);
					});
				}

				// Load the selected character from the dropdown
				function loadSelectedCharacter() {
					const characterList = document.getElementById('characterList');
					const charName = characterList.value;
					if (!charName) {
						alert('Please select a character to load.');
						return;
					}

					document.getElementById('charName').value = charName;
					loadSheet();
				}

				// Call this function when the page loads
				window.onload = function() {
					updateSkillModifiers();
					populateCharacterList();
					updateBar('health')
					updateBar('aura')
					updateBar('mana')
				};

				// Export character as a JSON file
				function exportCharacter() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name to export.');
						return;
					}

					const characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const charData = characters.find(char => char.name === charName);

					if (!charData) {
						alert(`No saved character found with the name "${charName}".`);
						return;
					}

					const jsonStr = JSON.stringify(charData, null, 2);
					const blob = new Blob([jsonStr], { type: 'application/json' });
					const url = URL.createObjectURL(blob);

					const a = document.createElement('a');
					a.href = url;
					a.download = `${charName}.json`;
					document.body.appendChild(a);
					a.click();
					document.body.removeChild(a);
					URL.revokeObjectURL(url);
				}

				// Import character from a JSON file
				function importCharacter(event) {
					const file = event.target.files[0];
					if (!file) return;

					const reader = new FileReader();
					reader.onload = function(e) {
						try {
							const charData = JSON.parse(e.target.result);

							// Get existing characters or initialize an empty array
							let characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];

							// Check if a character with this name already exists
							const existingIndex = characters.findIndex(char => char.name === charData.name);

							if (existingIndex >= 0) {
								// Update existing character
								characters[existingIndex] = charData;
							} else {
								// Add new character
								characters.push(charData);
							}

							// Save the updated array back to localStorage
							localStorage.setItem('ttrpgCharacters', JSON.stringify(characters));

							// Update the character list dropdown
							populateCharacterList();

							alert(`Character "${charData.name}" imported!`);
						} catch (error) {
							alert('Error importing character: ' + error.message);
						}
					};
					reader.readAsText(file);
				}
			
				function updateBar(type) {
					const currentInput = document.getElementById(type);
					const maxInput = document.getElementById(`max${type.charAt(0).toUpperCase() + type.slice(1)}`);
					const bar = document.getElementById(`${type}Bar`);

					const currentValue = parseInt(currentInput.value);
					const maxValue = parseInt(maxInput.value);

					if (currentValue > maxValue) {
						currentInput.value = maxValue;
					}

					const percentage = (currentValue / maxValue) * 100;
					bar.style.width = `${percentage}%`;
				}

			</script>
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
	</body>
</html>