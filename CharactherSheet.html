<!DOCTYPE HTML>
<html>
	<head>
		<title>Charachter Sheet</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .sheet-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .section {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .section-title {
            font-weight: bold;
            font-size: 2em;
            margin-bottom: 10px;
            color: #444;
			justify-content: center;
			display: flex;
        }
		/*Basic Info*/
		.form-row {
			display: flex; /* Arrange form groups in a row */
			gap: 20px; /* Space between form groups */
			margin-bottom: 10px; /* Space between rows */
		}

		.form-group {
			display: flex;
			flex-direction: column; /* Stack label and input vertically */
			flex: 1; /* Allow form groups to share space equally */
		}

		.form-group p {
			margin: 0;
			margin-bottom: 5px; /* Space between label and input */
			font-weight: bold;
		}

		.form-group input {
			width: 100%; /* Make inputs fill the form group */
			padding: 5px;
			box-sizing: border-box; /* Include padding in width */
		}
		/*Stats*/
        .stats-wrapper {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        .stats-container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
			justify-content: center; /* Center the save boxes horizontally */
			gap: 20px; /* Space between save boxes */
        }

        .stat-box {
            display: flex;
            flex-direction: column;
            align-items: center;
			text-align: center; /* Center text */
            width: 150px;
        }
		.save-box {
            display: flex;
            flex-direction: column;
            align-items: center;
			text-align: center; /* Center text */
            width: 200px;
			margin-top: 10px;
        }

        .stat-label {
            font-weight: bold;
			margin-top: -20px;
            margin-bottom: 5px;
			font-size: 150%;
  			color: skyblue;
			width: 100%; /* Ensure label takes full width of the save box */
        }

        .stat-input {
            width: 60px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
			text-align: center; /* Center input text */
        }

        textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
		/*Skills*/
		#skillsTable {
			width: 100%;
			border-collapse: collapse;
			margin-top: 10px;
		}

		#skillsTable th, #skillsTable td {
			border: 1px solid #ddd;
			padding: 8px;
			text-align: left;
		}

		#skillsTable th {
			background-color: black
		}

		#skillsTable tr:nth-child(even) {
			background-color: #f9f9f9;
		}

		.skill-modifier {
			width: 50px;
			background: #f0f0f0;
			border: none;
			padding: 5px;
			text-align: center;
			font-weight: bold;
		}
		.proficiency-button {
			width: 25px;
			height: 25px;
			margin-right: 3px;
			border: none;
			border-radius: 3px;
			cursor: pointer;
			font-weight: bold;
			background-color: #ddd;
			color: black;

			display: inline-flex;
			justify-content: center;
			align-items: center;
		}
		
		.proficiency-button.active {
			background-color: #4CAF50;
			color: white;
		}
		/*Resource Bars*/
		.resource-bars-container {
			display: flex;
            justify-content: center;
			gap: 20px;
			margin-top: 10px;
		}

		.resource-bar-wrapper {
			display: flex;
			flex-direction: column; /* Stack bar above inputs */
			align-items: flex-start;
			margin: 5px;
		}

		.bar-container {
			height: 20px;
			width: 100%;
			background-color: #ddd;
			border-radius: 10px;
			overflow: hidden;
		}

		.bar {
			height: 100%;
			border-radius: 10px;
			transition: width 0.3s;
		}

		.resource-inputs {
			display: flex;
			align-items: center;
			margin-top: 5px;
		}

		.resource-inputs label {
			margin-right: 5px;
		}
    </style>
	<body class="is-preload">
		<!-- Header -->
		<div id="header-placeholder"></div>
		<!-- Body-->
			<div class="sheet-container">
			<h1>Kastorix Character Sheet</h1>

			<div class="section">
				<div class="section-title">Character Info</div>

				<!-- First Row: Name, Species, Background -->
				<div class="form-row">
					<div class="form-group">
						<p>Name</p>
						<input type="text" placeholder="Character Name" id="charName">
					</div>
					<div class="form-group">
						<p>Species</p>
						<input type="text" placeholder="Species" id="charSpecies">
					</div>
					<div class="form-group">
						<p>Background</p>
						<input type="text" placeholder="Background" id="charBackground">
					</div>
				</div>

				<!-- Second Row: Level, Initiative, etc. -->
				<div class="form-row">
					<div class="form-group">
						<p>Level</p>
						<input type="number" placeholder="1" id="charLevel">
					</div>
					<div class="form-group">
						<p>Initiative</p>
						<input type="number" placeholder="0" id="initiative">
					</div>
					<div class="form-group">
						<p>Passive Perception</p>
						<input type="number" placeholder="10" id="passivePerception">
					</div>
				</div>
			</div>		

			 <!-- Resource Bars Container -->
			<div class="resource-bars-container">
				<!-- Health Bar -->
				<div class="resource-bar-wrapper">
					<div class="bar-container">
						<div id="healthBar" class="bar" style="width: 50%; background-color: #ff4d4d;"></div>
					</div>
					<div class="resource-inputs">
						<label for="health">Health:</label>
						<input type="number" id="health" min="0" max="100" value="10" oninput="updateBar('health')">
						/
						<input type="number" id="maxHealth" min="1" max="100" value="10" oninput="updateBar('health')">
					</div>
				</div>

				<!-- Aura Bar -->
				<div class="resource-bar-wrapper">
					<div class="bar-container">
						<div id="auraBar" class="bar" style="width: 30%; background-color: #4da6ff;"></div>
					</div>
					<div class="resource-inputs">
						<label for="aura">Aura:</label>
						<input type="number" id="aura" min="0" max="100" value="10" oninput="updateBar('aura')">
						/
						<input type="number" id="maxAura" min="1" max="100" value="10" oninput="updateBar('aura')">
					</div>
				</div>

				<!-- Mana Bar -->
				<div class="resource-bar-wrapper">
					<div class="bar-container">
						<div id="manaBar" class="bar" style="width: 70%; background-color: #b34dff;"></div>
					</div>
					<div class="resource-inputs">
						<label for="mana">Mana:</label>
						<input type="number" id="mana" min="0" max="100" value="10" oninput="updateBar('mana')">
						/
						<input type="number" id="maxMana" min="1" max="100" value="10" oninput="updateBar('mana')">
					</div>
				</div>
			</div>

			<div class="section">
				<div class="section-title">Stats</div>
				<div class="stats-wrapper">
					<div class="stats-container">
						<div class="stat-box">
							<p>Physique</p>
							<div class="stat-label">PHY</div>
							<input type="number" class="stat-input" id="phy" min="-5" max="10" oninput="setProficiency()" value="0">
						</div>
						<div class="stat-box">
							<p>Dexterity</p>
							<div class="stat-label">DEX</div>
							<input type="number" class="stat-input" id="dex" min="-5" max="10" oninput="setProficiency()" value="0">
						</div>
						<div class="stat-box">
							<p>Intelligence</p>
							<div class="stat-label">INT</div>
							<input type="number" class="stat-input" id="int" min="-5" max="10" oninput="setProficiency()" value="0">
						</div>
						<div class="stat-box">
							<p>Willpower</p>
							<div class="stat-label">WIL</div>
							<input type="number" class="stat-input" id="wil" min="-5" max="10" oninput="setProficiency()" value="0">
						</div>
					</div>
				</div>
			</div>

			<div class="section">
				<div class="section-title">Saving Throws</div>
				<div class="stats-wrapper">
					<div class="stats-container">
						<div class="save-box">
							<div class="stat-label">Fortitude (PHY)</div>
							<input type="number" class="stat-input" id="fortitude" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
							<div class ="save-proficiency-box">
								<button class="proficiency-button" onclick="setProficiency('fortitude', 0, PHY, this)">U</button> 
								<button class="proficiency-button" onclick="setProficiency('fortitude', 3, PHY, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('fortitude', 6, PHY, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('fortitude', 9, PHY, this)">M</button>
							</div>
						</div>
						<div class="save-box">
							<div class="stat-label">Reflex (DEX)</div>
							<input type="number" class="stat-input" id="reflex" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
							<div class ="save-proficiency-box">
								<button class="proficiency-button" onclick="setProficiency('reflex', 0, DEX, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('reflex', 3, DEX, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('reflex', 6, DEX, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('reflex', 9, DEX, this)">M</button>
							</div>
						</div>
						<div class="save-box">
							<div class="stat-label">Will <br>(WIL)</div>
							<input type="number" class="stat-input" id="will" min="-5" max="10" oninput="updateSkillModifiers()" value="0">
							<div class ="save-proficiency-box">
								<button class="proficiency-button" onclick="setProficiency('will', 0, WIL, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('will', 3, WIL, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('will', 6, WIL, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('will', 9, WIL, this)">M</button>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="section">
				<div class="section-title">Skills</div>
				<table id="skillsTable">
					<thead>
						<tr>
							<th>Skill</th>
							<th>Stat</th>
							<th>Modifier</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Acrobatics</td>
							<td>DEX</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('acrobatics', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('acrobatics', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('acrobatics', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('acrobatics', 9, this)">M</button>
								<input type="number" class="skill-input" id="acrobatics" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Arcana</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('arcana', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('arcana', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('arcana', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('arcana', 9, this)">M</button>
								<input type="number" class="skill-input" id="arcana" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Athletics</td>
							<td>PHY</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('athletics', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('athletics', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('athletics', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('athletics', 9, this)">M</button>
								<input type="number" class="skill-input" id="athletics" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Crafting</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('crafting', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('crafting', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('crafting', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('crafting', 9, this)">M</button>
								<input type="number" class="skill-input" id="crafting" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Deception</td>
							<td>WIL</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('deception', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('deception', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('deception', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('deception', 9, this)">M</button>
								<input type="number" class="skill-input" id="deception" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>History</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('history', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('history', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('history', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('history', 9, this)">M</button>
								<input type="number" class="skill-input" id="history" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Insight</td>
							<td>WIL</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('insight', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('insight', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('insight', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('insight', 9, this)">M</button>
								<input type="number" class="skill-input" id="insight" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Intimidation</td>
							<td>PHY</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('intimidation', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('intimidation', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('intimidation', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('intimidation', 9, this)">M</button>
								<input type="number" class="skill-input" id="intimidation" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Medicine</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('medicine', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('medicine', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('medicine', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('medicine', 9, this)">M</button>
								<input type="number" class="skill-input" id="medicine" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Mana Sensing</td>
							<td>WIL</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('manaSensing', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('manaSensing', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('manaSensing', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('manaSensing', 9, this)">M</button>
								<input type="number" class="skill-input" id="manaSensing" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Nature</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('nature', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('nature', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('nature', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('nature', 9, this)">M</button>
								<input type="number" class="skill-input" id="nature" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Perception</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('perception', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('perception', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('perception', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('perception', 9, this)">M</button>
								<input type="number" class="skill-input" id="perception" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Performance</td>
							<td>DEX</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('performance', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('performance', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('performance', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('performance', 9, this)">M</button>
								<input type="number" class="skill-input" id="performance" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Persuasion</td>
							<td>WIL</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('persuasion', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('persuasion', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('persuasion', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('persuasion', 9, this)">M</button>
								<input type="number" class="skill-input" id="persuasion" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Society</td>
							<td>INT</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('society', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('society', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('society', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('society', 9, this)">M</button>
								<input type="number" class="skill-input" id="society" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Sleight of Hand</td>
							<td>DEX</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('sleightOfHand', 9, this)">M</button>
								<input type="number" class="skill-input" id="sleightOfHand" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Stealth</td>
							<td>DEX</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('stealth', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('stealth', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('stealth', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('stealth', 9, this)">M</button>
								<input type="number" class="skill-input" id="stealth" min="-5" max="30">
							</td>
						</tr>
						<tr>
							<td>Survival</td>
							<td>WIL</td>
							<td>
								<button class="proficiency-button" onclick="setProficiency('survival', 0, this)">U</button>
								<button class="proficiency-button" onclick="setProficiency('survival', 3, this)">T</button>
								<button class="proficiency-button" onclick="setProficiency('survival', 6, this)">E</button>
								<button class="proficiency-button" onclick="setProficiency('survival', 9, this)">M</button>
								<input type="number" class="skill-input" id="survival" min="-5" max="30">
							</td>
						</tr>
					</tbody>
				</table>
			</div>


			<div class="section">
				<div class="section-title">Arcane Feats</div>
				<textarea id="arcaneFeats" placeholder="List your arcane feats here..."></textarea>
			</div>

			<div class="section">
				<div class="section-title">General Feats</div>
				<textarea id="generalFeats" placeholder="List your general feats here..."></textarea>
			</div>

			<div class="section">
				<div class="section-title">Equipment</div>
				<textarea id="equipment" placeholder="List your equipment here..."></textarea>
			</div>

			<div class="section">
				<div class="section-title">Notes</div>
				<textarea id="notes" placeholder="Additional notes..."></textarea>
			</div>

			<button onclick="saveSheet()">Save Character</button>
			<button onclick="loadSheet()">Load Character</button>
			<button onclick="deleteSheet()">Delete Character</button>
			<div class="section">
				<div class="section-title">Load Character</div>
				<select id="characterList" onchange="populateCharacter()">
					<option value="">Select a character...</option>
				</select>
				<button onclick="loadSelectedCharacter()">Load Selected</button>
			</div>

			<div class="section">
				<div class="section-title">Export/Import</div>
				<button onclick="exportCharacter()">Export Character</button>
				<input type="file" id="importFile" accept=".json" onchange="importCharacter(event)" style="display: none;">
				<button onclick="document.getElementById('importFile').click()">Import Character</button>
			</div>

		</div>
		<!-- Footer -->
			<div id="footer">
				<!-- Copyright -->
					<ul class="copyright">
						<li>&copy; Edvin Skogsholm Sanne's Portfolio. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
			</div>
		<!-- Scripts -->
			<script>
				fetch('rpgheader.html')
					.then(response => response.text())
					.then(data => {
						document.getElementById('header-placeholder').innerHTML = data;
					});

				// Close dropdowns when clicking outside
				window.onclick = function(event) {
					if (!event.target.matches('.dropbtn')) {
						var dropdowns = document.getElementsByClassName("dropdown-content");
						for (var i = 0; i < dropdowns.length; i++) {
							var openDropdown = dropdowns[i];
							if (openDropdown.style.display === "block") {
								openDropdown.style.display = "none";
							}
						}
					}
				};

				function setProficiency(skillId, proficiencyBonus, stat, button) {
					const buttons = button.parentNode.querySelectorAll('.proficiency-button');
					buttons.forEach(btn => btn.classList.remove('active'));
					button.classList.add('active');

					saves.forEach(element => {
						if (skillId == element) {
							console.log("Same", element)
						}
					});
				}

				function saveSheet() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name.');
						return;
					}

					const charData = {
						name: charName,
						species: document.getElementById('charSpecies').value,
						level: document.getElementById('charLevel').value,
						initiative: document.getElementById('initiative').value,
						passivePerception: document.getElementById('passivePerception').value,

						health: document.getElementById('health').value,
						maxHealth: document.getElementById('maxHealth').value,
						aura: document.getElementById('aura').value,
						maxAura: document.getElementById('maxAura').value,
						mana: document.getElementById('mana').value,
						maxMana: document.getElementById('maxMana').value,

						stats: {
							phy: document.getElementById('phy').value,
							dex: document.getElementById('dex').value,
							int: document.getElementById('int').value,
							wil: document.getElementById('wil').value,
						},
						saves: {
							fortitude: document.getElementById('fortitude').value,
							reflex: document.getElementById('reflex').value,
							will: document.getElementById('will').value,
						},
						skills: {
							acrobatics: document.getElementById('acrobatics').value,
							arcana: document.getElementById('arcana').value,
							athletics: document.getElementById('athletics').value,
							crafting: document.getElementById('crafting').value,
							deception: document.getElementById('deception').value,
							history: document.getElementById('history').value,
							insight: document.getElementById('insight').value,
							intimidation: document.getElementById('intimidation').value,
							medicine: document.getElementById('medicine').value,
							manaSensing: document.getElementById('manaSensing').value,
							nature: document.getElementById('nature').value,
							perception: document.getElementById('perception').value,
							performance: document.getElementById('performance').value,
							persuasion: document.getElementById('persuasion').value,
							society: document.getElementById('society').value,
							sleightOfHand: document.getElementById('sleightOfHand').value,
							stealth: document.getElementById('stealth').value,
							survival: document.getElementById('survival').value
						},
						arcaneFeats: document.getElementById('arcaneFeats').value,
						generalFeats: document.getElementById('generalFeats').value,
						equipment: document.getElementById('equipment').value,
						notes: document.getElementById('notes').value,
					};

					let characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const existingIndex = characters.findIndex(char => char.name === charName);

					if (existingIndex >= 0) {
						characters[existingIndex] = charData;
					} else {
						characters.push(charData);
					}

					localStorage.setItem('ttrpgCharacters', JSON.stringify(characters));
					alert(`Character "${charName}" saved!`);
				}

				function loadSheet() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name to load.');
						return;
					}

					const characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const charData = characters.find(char => char.name === charName);

					if (charData) {
						document.getElementById('charName').value = charData.name;
						document.getElementById('charSpecies').value = charData.species;
						document.getElementById('charLevel').value = charData.level;
						document.getElementById('initiative').value = charData.initiative;
						document.getElementById('passivePerception').value = charData.passivePerception;

						document.getElementById('health').value = charData.health;
						document.getElementById('maxHealth').value = charData.maxHealth;
						document.getElementById('aura').value = charData.aura;
						document.getElementById('maxAura').value = charData.maxAura;
						document.getElementById('mana').value = charData.mana;
						document.getElementById('maxMana').value = charData.maxMana;

						document.getElementById('phy').value = charData.stats.phy;
						document.getElementById('dex').value = charData.stats.dex;
						document.getElementById('int').value = charData.stats.int;
						document.getElementById('wil').value = charData.stats.wil;

						document.getElementById('acrobatics').value = charData.skills.acrobatics;
						document.getElementById('arcana').value = charData.skills.arcana;
						document.getElementById('athletics').value = charData.skills.athletics;
						document.getElementById('crafting').value = charData.skills.crafting;
						document.getElementById('deception').value = charData.skills.deception;
						document.getElementById('history').value = charData.skills.history;
						document.getElementById('insight').value = charData.skills.insight;
						document.getElementById('intimidation').value = charData.skills.intimidation;
						document.getElementById('medicine').value = charData.skills.medicine;
						document.getElementById('manaSensing').value = charData.skills.manaSensing;
						document.getElementById('nature').value = charData.skills.nature;
						document.getElementById('perception').value = charData.skills.perception;
						document.getElementById('performance').value = charData.skills.performance;
						document.getElementById('persuasion').value = charData.skills.persuasion;
						document.getElementById('society').value = charData.skills.society;
						document.getElementById('sleightOfHand').value = charData.skills.sleightOfHand;
						document.getElementById('stealth').value = charData.skills.stealth;
						document.getElementById('survival').value = charData.skills.survival;

						document.getElementById('arcaneFeats').value = charData.arcaneFeats;
						document.getElementById('generalFeats').value = charData.generalFeats;
						document.getElementById('equipment').value = charData.equipment;
						document.getElementById('notes').value = charData.notes;

						alert(`Character "${charName}" loaded!`);
					} else {
						alert(`No saved character found with the name "${charName}".`);
					}
				}


				// Delete a character
				function deleteSheet() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name to delete.');
						return;
					}

					let characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const updatedCharacters = characters.filter(char => char.name !== charName);

					if (updatedCharacters.length === characters.length) {
						alert(`No saved character found with the name "${charName}".`);
					} else {
						localStorage.setItem('ttrpgCharacters', JSON.stringify(updatedCharacters));
						alert(`Character "${charName}" deleted!`);
					}
				}

				// Populate the character list dropdown
				function populateCharacterList() {
					const characterList = document.getElementById('characterList');
					characterList.innerHTML = '<option value="">Select a character...</option>';

					const characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					characters.forEach(char => {
						const option = document.createElement('option');
						option.value = char.name;
						option.textContent = char.name;
						characterList.appendChild(option);
					});
				}

				// Load the selected character from the dropdown
				function loadSelectedCharacter() {
					const characterList = document.getElementById('characterList');
					const charName = characterList.value;
					if (!charName) {
						alert('Please select a character to load.');
						return;
					}

					document.getElementById('charName').value = charName;
					loadSheet();
				}

				// Call this function when the page loads
				window.onload = function() {
					updateSkillModifiers();
					populateCharacterList();
					updateBar('health')
					updateBar('aura')
					updateBar('mana')
				};

				// Export character as a JSON file
				function exportCharacter() {
					const charName = document.getElementById('charName').value;
					if (!charName) {
						alert('Please enter a character name to export.');
						return;
					}

					const characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];
					const charData = characters.find(char => char.name === charName);

					if (!charData) {
						alert(`No saved character found with the name "${charName}".`);
						return;
					}

					const jsonStr = JSON.stringify(charData, null, 2);
					const blob = new Blob([jsonStr], { type: 'application/json' });
					const url = URL.createObjectURL(blob);

					const a = document.createElement('a');
					a.href = url;
					a.download = `${charName}.json`;
					document.body.appendChild(a);
					a.click();
					document.body.removeChild(a);
					URL.revokeObjectURL(url);
				}

				// Import character from a JSON file
				function importCharacter(event) {
					const file = event.target.files[0];
					if (!file) return;

					const reader = new FileReader();
					reader.onload = function(e) {
						try {
							const charData = JSON.parse(e.target.result);

							// Get existing characters or initialize an empty array
							let characters = JSON.parse(localStorage.getItem('ttrpgCharacters')) || [];

							// Check if a character with this name already exists
							const existingIndex = characters.findIndex(char => char.name === charData.name);

							if (existingIndex >= 0) {
								// Update existing character
								characters[existingIndex] = charData;
							} else {
								// Add new character
								characters.push(charData);
							}

							// Save the updated array back to localStorage
							localStorage.setItem('ttrpgCharacters', JSON.stringify(characters));

							// Update the character list dropdown
							populateCharacterList();

							alert(`Character "${charData.name}" imported!`);
						} catch (error) {
							alert('Error importing character: ' + error.message);
						}
					};
					reader.readAsText(file);
				}
			
				function updateBar(type) {
					const currentInput = document.getElementById(type);
					const maxInput = document.getElementById(`max${type.charAt(0).toUpperCase() + type.slice(1)}`);
					const bar = document.getElementById(`${type}Bar`);

					const currentValue = parseInt(currentInput.value);
					const maxValue = parseInt(maxInput.value);

					if (currentValue > maxValue) {
						currentInput.value = maxValue;
					}

					const percentage = (currentValue / maxValue) * 100;
					bar.style.width = `${percentage}%`;
				}

			</script>
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
	</body>
</html>